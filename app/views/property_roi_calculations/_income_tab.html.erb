<!-- app/views/property_roi_calculations/_income_tab.html.erb -->

<div class="tab-pane fade" id="income" role="tabpanel" aria-labelledby="income-tab">
  <div class="bg-orange-50 p-4 rounded-3 mb-4">
    <h4 class="mb-3 text-orange-800">Income Information</h4>
    
    <div class="row g-3">
      <div class="col-md-12">
        <label class="form-label text-orange-700 fw-medium d-flex justify-content-between">
          <span>Monthly Rental Income</span>
          <span class="badge bg-orange-600 monthly-rental-badge">RM 2,500</span>
        </label>
        <div class="input-group">
          <span class="input-group-text currency-symbol">RM</span>
          <%= f.number_field :monthly_rental, class: "form-control", placeholder: "Monthly Rental", step: "0.01", required: true %>
        </div>
        <div class="slider-container mt-2">
          <input type="range" class="form-range monthly-rental-slider" min="500" max="10000" step="100" value="2500">
          <div class="d-flex justify-content-between">
            <small class="text-muted">500</small>
            <small class="text-muted">5,000</small>
            <small class="text-muted">10,000</small>
          </div>
        </div>
        <div class="mt-1">
          <small class="text-orange-600" id="annual-rental">Annual: RM 30,000</small>
        </div>
        
        <!-- Rental yield indicator -->
        <div class="rental-yield-container mt-2">
          <div class="d-flex justify-content-between align-items-center mb-1">
            <span class="text-orange-700">Gross Rental Yield:</span>
            <span class="badge rental-yield-badge" id="rental-yield-badge">6.0%</span>
          </div>
          <div class="progress" style="height: 8px;">
            <div class="progress-bar rental-yield-progress" role="progressbar" style="width: 60%;" id="rental-yield-bar"></div>
          </div>
          <div class="d-flex justify-content-between mt-1">
            <small class="text-muted">Poor (<3%)</small>
            <small class="text-muted">Good (5-7%)</small>
            <small class="text-muted">Excellent (>9%)</small>
          </div>
        </div>
      </div>
      
      <div class="col-md-12">
        <label class="form-label text-orange-700 fw-medium">Other Monthly Income</label>
        <div class="input-group">
          <span class="input-group-text currency-symbol">RM</span>
          <%= f.number_field :other_income, class: "form-control", placeholder: "Other Monthly Income", step: "0.01", value: 200 %>
        </div>
        <div class="slider-container mt-2">
          <input type="range" class="form-range other-income-slider" min="0" max="1000" step="50" value="200">
        </div>
        <div class="mt-1">
          <small class="text-orange-600">E.g., parking, laundry, storage fees</small>
        </div>
      </div>
      
      <div class="col-md-12">
        <label class="form-label text-orange-700 fw-medium d-flex justify-content-between">
          <span>Expected Occupancy Rate (%)</span>
          <span class="badge bg-orange-600 occupancy-rate-badge">95%</span>
        </label>
        <div class="slider-container">
          <%= f.range_field :occupancy_rate, class: "form-range occupancy-rate-slider", min: "50", max: "100", step: "1", value: "95", required: true %>
          <div class="d-flex justify-content-between">
            <small class="text-muted">50%</small>
            <small class="text-muted">75%</small>
            <small class="text-muted">100%</small>
          </div>
        </div>
        
        <!-- Occupancy visualization -->
        <div class="occupancy-visualization mt-2">
          <div class="d-flex align-items-center">
            <div class="occupancy-units" id="occupancy-units">
              <!-- Will be populated by JS -->
            </div>
          </div>
        </div>
      </div>
      
      <div class="col-md-12">
        <label class="form-label text-orange-700 fw-medium d-flex justify-content-between">
          <span>Annual Rental Growth (%)</span>
          <span class="badge bg-orange-600 rental-growth-badge">2.0%</span>
        </label>
        <div class="slider-container">
          <%= f.range_field :rental_growth_rate, class: "form-range rental-growth-slider", min: "0", max: "10", step: "0.1", value: "2" %>
          <div class="d-flex justify-content-between">
            <small class="text-muted">0%</small>
            <small class="text-muted">5%</small>
            <small class="text-muted">10%</small>
          </div>
        </div>
        
        <!-- Growth visualization -->
        <div class="growth-visualization mt-3">
          <div class="chart-container" style="height: 150px; position: relative;">
            <canvas id="rentalGrowthChart"></canvas>
          </div>
        </div>
      </div>
    </div>
    
    <div class="mt-4 p-3 bg-orange-100 rounded-3">
      <h5 class="text-orange-800 fw-semibold mb-1">Effective Annual Income</h5>
      <div class="d-flex justify-content-between align-items-center">
        <p class="fs-4 fw-bold text-orange-600 mb-0" id="effective-annual-income">RM 30,900</p>
        <div class="income-breakdown-btn" data-bs-toggle="tooltip" title="Show income breakdown">
          <i class="fas fa-chart-pie"></i>
        </div>
      </div>
      <p class="small text-orange-700 mt-1">Rental income adjusted for occupancy rate + other income</p>
      
      <!-- Income breakdown chart (hidden by default) -->
      <div class="income-breakdown-chart mt-3" style="display: none;">
        <div class="chart-container" style="height: 200px; position: relative;">
          <canvas id="incomeBreakdownChart"></canvas>
        </div>
      </div>
    </div>
    
    <!-- Add Back/Next buttons -->
    <div class="d-flex justify-content-between mt-4">
      <button type="button" class="btn btn-outline-secondary back-tab">
        <i class="fas fa-arrow-left me-1"></i> Back to Property
      </button>
      <button type="button" class="btn btn-orange-600 text-white next-tab">
        Continue to Expenses <i class="fas fa-arrow-right ms-1"></i>
      </button>
    </div>
  </div>
</div>